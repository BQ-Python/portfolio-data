name: Mise √† jour Quotidienne des Donn√©es

on:
  schedule:
    # 1. Planification pour l'heure d'√©t√© (23h50 CEST = 21h50 UTC)
    - cron: '50 21 * * *' 
    # 2. Planification pour l'heure d'hiver (23h50 CET = 22h50 UTC)
    - cron: '50 22 * * *' 

jobs:
  update-data:
    runs-on: ubuntu-latest

    steps:
      # √âtape 1 : Cloner le d√©p√¥t
      - name: Checkout du code
        uses: actions/checkout@v4
        
      # √âtape 2 : Configuration de Python et installation des d√©pendances (si n√©cessaire)
      - name: Configuration de Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # √âtape 3 : Ex√©cuter le script de mise √† jour et d√©finir le fuseau horaire
      - name: Ex√©cuter le script de mise √† jour des donn√©es
        # Nous d√©finissons la variable d'environnement TZ sur Europe/Paris pour le script
        env:
          TZ: Europe/Paris 
        run: python update_script.py

      # √âtape 4 : Configuration de Git pour le commit
      - name: Configuration de Git
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

      # √âtape 5 : Commiter et pusher les changements
      - name: Commiter et Pusher les changements
        run: |
          # Remplacez 'mon_fichier_de_donnees.csv' par le nom de votre fichier
          git add mon_fichier_de_donnees.csv
          
          if ! git diff --cached --exit-code; then
            git commit -m "ü§ñ Mise √† jour des donn√©es du $(date +%Y-%m-%d)"
            git push
          else
            echo "Aucun changement d√©tect√©, pas de commit n√©cessaire."
          fi
